console.log("connected 1_global.js");const url_geoip="https://freegeoip.app/json/",currentTheme=localStorage.getItem("theme")?localStorage.getItem("theme"):null,toggleSwitch=document.querySelector(".theme-checkbox");function switchTheme(e){e.target.checked?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}currentTheme&&(document.documentElement.setAttribute("data-theme",currentTheme),"dark"===currentTheme&&(toggleSwitch.checked=!0)),toggleSwitch.addEventListener("change",switchTheme,!1);const supportedLangs=["en","ru","es"];let locale=getLocale(supportedLangs);const language=locale;function goBack(){window.history.back()}document.querySelectorAll(".dropdown-menu").forEach((e=>{e.addEventListener("click",(e=>{e.stopPropagation()}))}));const sessionIpData=async()=>{if(sessionStorage.getItem("ipCurrent")||null){return JSON.parse(sessionStorage.getItem("ipCurrent"))||null}{const e=await getFreshData(url_geoip);return sessionStorage.setItem("ipCurrent",JSON.stringify(e)),addtoIpHistory(e),e}},ipData=async()=>{const e=await sessionIpData();console.log("from ipdata func: \n",e)};function addtoIpHistory(e){Array.prototype.pushMax=function(e,n){this.length>=n&&this.shift(),this.push(e)};const n=JSON.parse(localStorage.getItem("ipHistory"))||[];n.pushMax(e,10),localStorage.setItem("ipHistory",JSON.stringify(n))}function getLocale(e){let n;if(getCookie("language")){n=e.indexOf(getCookie("language"))>=0?getCookie("language"):"en"}else n=navigator.languages[0].substring(0,2);return n}function getCookie(e){const n=e+"=",t=document.cookie.split(";");for(let e=0;e<t.length;e++){let a=t[e];for(;" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(n))return a.substring(n.length,a.length)}return""}function geoLocate(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){const n=e.coords.latitude,t=e.coords.longitude;console.log("latitude",n,"longitude",t),reverseGeocode(n,t)}),(function(){console.error("Cannot retrieve your position. Please enable geolocation in your browser")})):console.log("Geolocation is not supported by your browser")}ipData(),console.log("connected 2.0_navbar.js");const searchContainerMain=document.querySelector("#search-container-main"),searchForm=document.querySelector(".search-form"),searchInput=document.querySelector(".search-input"),langSelectors=document.querySelectorAll("#lang a"),authBtn=document.querySelector("#auth-btn"),authModal=new bootstrap.Modal(document.getElementById("auth-modal")),registerTab=new bootstrap.Tab(document.querySelector('#authTab a[href="#register-tab-page"]')),loginTab=new bootstrap.Tab(document.querySelector('#authTab a[href="#login-tab-page"]')),regbutton=document.querySelector("#btn-register"),loginbutton=document.querySelector("#btn-login"),reglink=document.querySelector("#register-link"),loginlink=document.querySelector("#login-link"),hideBtns=document.querySelectorAll(".toggle-hide");function toggleShow(e){"password"===e.previousElementSibling.type?(e.previousElementSibling.type="text",e.children[0].style.display="none",e.children[1].style.display="block"):(e.previousElementSibling.type="password",e.children[0].style.display="block",e.children[1].style.display="none")}authBtn&&authBtn.addEventListener("click",(()=>{authModal.show(),loginTab.show()})),reglink.addEventListener("click",(function(e){e.preventDefault(),registerTab.show()})),loginlink.addEventListener("click",(function(e){e.preventDefault(),loginTab.show()})),hideBtns.forEach((e=>{e.addEventListener("click",(()=>{toggleShow(e)}))}));const themeCheckbox=document.querySelector(".theme-checkbox");themeCheckbox.addEventListener("change",(()=>{document.body.classList.toggle("light")}));const langCookieAge=31536e3;langSelectors.forEach((e=>{e.addEventListener("click",(()=>{document.cookie="language="+e.id+"; max-age=31536000;path=/",location.reload()}))})),console.log("connected 2.1_regvalidate.js");const regform=document.querySelector("#reg-form"),regemail=document.querySelector("#reg-email"),regpassword=document.querySelector("#reg-password"),regcaptcha=document.querySelector("#reg-form .g-recaptcha"),emailsmall=document.querySelector("#reg-form .email-small"),emailerr=document.querySelector("#reg-form .email-error"),captchasmall=document.querySelector("#reg-form .captcha-small"),loginForm=document.querySelector("#login-form"),loginemail=document.querySelector("#login-email"),loginCaptcha=document.querySelector("#login-form .g-recaptcha"),loginBtn=document.querySelector("#btn-login"),loginEmailsmall=document.querySelector("#login-form .email-small"),loginCaptchasmall=document.querySelector("#login-form .captcha-small");let registrationErrors={emailbackend:!0,email:!0,password:!0,recaptcha:!0},loginErrors={email:!0};function setErrorFor(e,n){const t=e.parentElement;t.querySelector(".small").innerText=n,t.className="form-group error"}function setSuccessFor(e){e.parentElement.className="form-group success"}function isEmail(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function checkEmail(){let e=document.querySelector("#reg-email").value.toLowerCase();fetch("/usercheck",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}).then((e=>e.json())).then((e=>{if(console.log(e),"success"!=e.message){emailsmall.innerHTML=""+e.message;emailsmall.parentElement.className="form-group error",registrationErrors.emailbackend=!0}else registrationErrors.emailbackend=!1}))}function allFalse(e){for(let n in e)if(e[n])return!1;return!0}function validateEmail(e){const n=e.value;""===n||null===n?(setErrorFor(e,"Email cannot be blank"),registrationErrors.email=!0,loginErrors.email=!0):n.length<=6?(setErrorFor(e,"Email too short"),registrationErrors.email=!0,loginErrors.email=!0):isEmail(n)?(setSuccessFor(e),registrationErrors.email=!1,loginErrors.email=!1):(setErrorFor(e,"Email is not valid"),registrationErrors.email=!0,loginErrors.email=!0)}function validatePassword(){passValue=regpassword.value,""===passValue||null===passValue?(setErrorFor(regpassword,"Password cannot be blank"),registrationErrors.password=!0):passValue.length<=6?(setErrorFor(regpassword,"Password must be 7+ characters"),registrationErrors.password=!0):(setSuccessFor(regpassword),registrationErrors.password=!1)}function validateCaptcha(){regemail.value;0!=registrationErrors.recaptcha?setErrorFor(regcaptcha,"Are you human? Please check captcha"):setSuccessFor(regcaptcha)}function recaptchaCheck(){registrationErrors.recaptcha=!1,setSuccessFor(regcaptcha)}function recaptchaCheckExp(){registrationErrors.recaptcha=!0,setErrorFor(regcaptcha,"Are you human?")}function calPasswordStrength(e){var n=0;if(!e)return n;for(var t=new Object,a=0;a<e.length;a++)t[e[a]]=(t[e[a]]||0)+1,n+=5/t[e[a]];var r={digits:/\d/.test(e),lower:/[a-z]/.test(e),upper:/[A-Z]/.test(e),nonWords:/\W/.test(e)};for(var o in variationCount=0,r)variationCount+=1==r[o]?1:0;return n+=10*(variationCount-1),parseInt(n)}regemail.addEventListener("focusin",(()=>{registrationErrors.emailbackend=!0})),document.querySelectorAll(".auth-form").forEach((e=>{const n=e.querySelector(".submit-loader"),t=e.querySelector(".auth-btn");e.addEventListener("submit",(a=>"reg-form"!==e.id||allFalse(registrationErrors)?"login-form"!==e.id||(validateEmail(loginemail),allFalse(loginErrors))?(t.disabled=!0,t.style.pointerEvents="none",t.style.opacity=.3,void(n.innerHTML='\n      <?xml version="1.0" encoding="utf-8"?>\n      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; background: none; display: block; shape-rendering: auto;" width="50px" height="50px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">\n      <path d="M10 50A40 40 0 0 0 90 50A40 43 0 0 1 10 50" fill="#ececec" stroke="none">\n        <animateTransform attributeName="transform" type="rotate" dur="1s" repeatCount="indefinite" keyTimes="0;1" values="0 50 51.5;360 50 51.5"></animateTransform>\n      </path>\n      \x3c!-- [ldio] generated by https://loading.io/ --\x3e</svg>\n    ')):(a.preventDefault(),console.log("login-form validation"),console.log(loginErrors),console.log(allFalse(loginErrors)),!1):(a.preventDefault(),validateEmail(regemail),validatePassword(),validateCaptcha(),checkEmail(),console.log("reg-form validation"),console.log(registrationErrors),console.log(allFalse(registrationErrors)),!1)))})),regemail.addEventListener("focusout",(()=>{checkEmail()})),regemail.addEventListener("keyup",(e=>{validateEmail(regemail)})),loginemail.addEventListener("focusout",(e=>{validateEmail(loginemail)})),regpassword.addEventListener("keyup",(e=>{validatePassword()})),console.log("connected 2.2_pwmeter.js"),document.querySelector("#reg-password").addEventListener("keyup",(function(){const e=document.getElementById("passwordmessage"),n=document.querySelectorAll(".pwmeter span");let t=calPasswordStrength(this.value);t<=40?(n[0].style.backgroundColor="red",n[0].className="meter-span-on",n[1].className="meter-span-off",n[2].className="meter-span-off",e.style.color="coral",e.innerHTML="Weak password"):t<=77?(n[1].style.backgroundColor="orange",n[1].className="meter-span-on",n[2].className="meter-span-off",e.style.color="orange",e.innerHTML="Password is average"):(n[2].style.backgroundColor="green",n[2].className="meter-span-on",e.style.color="green",e.innerHTML="Your password is strong"),""==this.value&&(n[0].className="meter-span-off",n[1].className="meter-span-off",n[2].className="meter-span-off",e.innerHTML="")})),console.log("connected 2.3_operations.js"),"true"===sessionStorage.getItem("regformErrors")&&document.addEventListener("DOMContentLoaded",(()=>{authModal.show(),registerTab.show()})),sessionStorage.setItem("regformErrors",!1),"true"===sessionStorage.getItem("loginErrors")&&document.addEventListener("DOMContentLoaded",(()=>{authModal.show(),loginTab.show()})),sessionStorage.setItem("loginErrors",!1),"/"!=location.pathname&&document.querySelector("#auth-modal").addEventListener("hide.bs.modal",(e=>{console.log("hida maida"),window.location.href="/"}));const showMegamenuMovie=e=>{const n=document.querySelector(".movie-column");if(n.innerHTML="",!e)return main.innerHTML='<div class="section-title">Movie info not available<span class="section-backlogo">Movie info not available</span></div>',!1;const{title:t,poster_path:a,vote_average:r,overview:o,release_date:s,genre_ids:i,id:l}=e,c=document.createElement("div");c.classList.add("movieCol"),c.innerHTML=`\n    \n      <div style="background-image: url('${img_path+a}'); background-size: cover; height: 250px; width: 100px"></div>\n        <div>\n          <h3>${t}</h3>\n            <span>${new Date(s).getFullYear()}</span> \n            <span class="pipe">|</span> \n            <span class="${getClassByRate(r).class}">\n              ${r} <i class="${getClassByRate(r).star}"></i></span>\n            <span class="pipe">|</span> \n            <span>${getGenres(i)}</span>\n        </div>\n        \n        <p>${o}</p>\n      </div>\n    </div>\n  `,n.appendChild(c),c.addEventListener("click",(function(){fetchMovie(l)}))};console.log("connected 3_data_prep.js");const cacheInterval=2e4,url_params=new URLSearchParams({language:language}),img_path="https://image.tmdb.org/t/p/w300",img_path_highres="https://image.tmdb.org/t/p/w1280",url_movie_genres="/api/movies/genres?",url_search="/api/movies/search?query=",url_theatersNow="/api/theaters/nowplaying?",url_theatersUpcoming="/api/theaters/upcoming?",url_moviesTrend="/api/movies/trending?",url_moviesPopular="/api/movies/popular?",url_movieInfo="/api/movies/movieinfo/",url_weatherInfo="/api/weather?",marqueeReel=document.querySelector(".marquee-content"),gallery=document.querySelector(".carousel-inner"),galleryThumbnails=document.querySelector(".carousel-indicators"),main=document.querySelector("main"),section=document.querySelector("section"),header=document.querySelector("header"),weather=document.querySelector(".weather-data"),clientInfo=document.querySelector(".client-data");let movieGenres;searchForm.addEventListener("submit",(async e=>{e.preventDefault();const n=searchInput.value,t=url_search+n+"&"+url_params;if(n){header.innerHTML="",main.innerHTML="",document.querySelector("header").innerHTML="";toMain(await fetchData(t)),searchInput.value=""}}));const writeToCache=(e,n)=>localStorage.setItem(e,JSON.stringify(n)),readFromCache=e=>JSON.parse(localStorage.getItem(e))||null;async function getFreshData(e){const n=await fetch(e);let t=await n.json();return t.time=Date.now(),t}const fetchData=async(e,n=2e4,t=!0)=>{const a=readFromCache(e);if(a&&a.time>Date.now()-n)return a;{const n=await getFreshData(e);return t&&writeToCache(e,n),n}};async function fetchMovie(e){const n=`${url_movieInfo+e}?${url_params}`;watchMovie(await fetchData(n))}const showMovieListGenres=e=>{const n=movieGenres.genres;let t=[];return e.map((e=>{n.map((n=>{e==n.id&&t.push(n.name)}))})),t.join(", ")},showMovieGenres=e=>{let n=[];return e.map((e=>{n.push(e.name)})),n.join(", ")};function getClassByRate(e){return 0==e?{class:"hide"}:e>=7?{class:"green",star:"fas fa-star"}:e>5?{class:"orange",star:"fas fa-star-half"}:{class:"red",star:"far fa-star"}}async function initData(){await showGenres(),showMoviesTrending(),showMoviesPopular();const e=await sessionIpData();showWeather(e),showClientside(e)}async function showGenres(){movieGenres=await fetchData(url_movie_genres+url_params,864e5),document.querySelectorAll(".genres-list").forEach((e=>{toGenresList(movieGenres.genres,e)}))}async function showMoviesPopular(){main&&(moviesPopular=await fetchData(url_moviesPopular+url_params),toMain(moviesPopular))}async function showMoviesTrending(){gallery&&(moviesTrending=await fetchData(url_moviesTrend+url_params),toCarousel(moviesTrending))}async function showWeather(e){if(weather){const n=new URLSearchParams({lat:e.latitude,lon:e.longitude,units:"metric",lang:language}),t=await fetchData("/api/weather?"+n);toWeather(t),console.log("received weather data: ",t)}}async function showClientside(e){if(clientInfo){1,toClientInfo(e)}}function toCarousel(e){gallery.innerHTML="",galleryThumbnails.innerHTML="",e.results.forEach(((e,n)=>{const{title:t,poster_path:a,vote_average:r,backdrop_path:o,overview:s,release_date:i,genre_ids:l,id:c}=e,d=document.createElement("div");d.classList.add("carousel-item"),0===n&&(d.className+=" active"),d.style.backgroundImage=`url("${img_path_highres+o}")`,d.innerHTML=`\n      <div class="fade-overlay"></div>\n      <div class="carousel-caption d-md-block">\n      \x3c!-- <div class="carousel-caption d-none d-md-block"> --\x3e\n        <h2 class="display-4">${t}</h2>\n          <p class="lead overview-header__stats">\n            <span class="carousel-caption-overview">${new Date(i).getFullYear()}</span> \n            <span class="pipe carousel-caption-overview">|</span> \n            <span class="carousel-caption-overview">\n              <i class="${0==r?"":getClassByRate(r).star}"></i> ${0==r?"":r} </span>\n            <span class="pipe carousel-caption-overview">|</span> \n            <span class="carousel-caption-overview">${showMovieListGenres(l)}</span>\n          </p>\n        <div class="film-details">\n          <a class="button-container-${n}" href="#"></a>\n          <p class="lead">${s.substring(0,200)}...</p>\n        </div>\n      </div>\n      `,gallery.appendChild(d);const u=document.createElement("button");u.classList.add("btn-custom"),u.className+=" mb-3",u.innerHTML='<i class="fas fa-play"></i> Play',u.addEventListener("click",(function(){fetchMovie(c)})),document.querySelector(".button-container-"+n).appendChild(u);const m=document.createElement("li");m.setAttribute("data-target","#carousel-main"),m.setAttribute("data-slide-to",""+n),m.innerHTML=`\n      <div class="card-dummy">\n        <img src="${img_path+a}">\n      </div>\n    `,marqueeReel.appendChild(m)})),infiniteMarquee()}function toMain(e){if(e.length<1)return main.innerHTML="",main.innerHTML='<div class="section-title">No Results Found<span class="section-backlogo">No Results Found</span></div>',!1;main.innerHTML="",main.innerHTML='<div class="section-title">POPULAR NOW<span class="section-backlogo">POPULAR</span></div>',e.results.forEach(((e,n)=>{const{title:t,poster_path:a,vote_average:r,backdrop_path:o,overview:s,release_date:i,genre_ids:l,id:c}=e,d=document.createElement("div");d.classList.add("movie"),d.innerHTML=`\n      <div id="burger" class="burger">\n        <div class="line1"></div>\n        <div class="line2"></div>\n        <div class="line3"></div>\n      </div>\n      \n      <div class="img-container">\n        <div class="img" style="background-image: url('${img_path+a}');"></div>\n        <div class="overlay"></div>\n      </div>\n      <div class="movie-info">\n        <div class="overview">\n          <div class="overview-header">\n            <h3>${t}</h3>\n            <div class="overview-header__stats">\n              <span>${new Date(i).getFullYear()}</span> \n              <span class="pipe">|</span> \n              <span class="${getClassByRate(r).class}">\n                ${r} <i class="${getClassByRate(r).star}"></i></span>\n              <span class="pipe">|</span> \n              <span>${showMovieListGenres(l)}</span>\n            </div>\n          </div>\n          \n          <div class="overview-body">\n            <p>${s}</p>\n          </div>\n          <div class="overview-footer">\n          </div>          \n        </div>\n      </div>\n    `,main.appendChild(d),d.addEventListener("click",(function(){fetchMovie(c)}))}))}function watchMovie(e){const{title:n,poster_path:t,vote_average:a,backdrop_path:r,overview:o,release_date:s,genres:i}=e;header.innerHTML="",main.innerHTML="",section.innerHTML=`\n    \x3c!-- <div class="section-title">Title<span class="section-backlogo">Title</span></div> --\x3e\n    \x3c!-- <h1>Title</h1> --\x3e\n\n    <section class="watch-movie">\n      <div class="watch-movie-bg-decor">${n}</div>\n      <div class="watch-movie-bg"></div>\n      <div class="container">\n        <div class="row">\n          <div class="col-lg-6 col-sm-12 padding-0">\n            <div class="movie-glance">\n              <div class="film-page_poster">\n                <img class="img-fluid" src="${img_path+t}" alt="${n}" title="${n}"> \n              </div>\n              <div class="movie-info-container">\n                <div class="">\n                  <div class="film-page_title">${n}</div>\n                  <div class="film-page_title-stats">\n                    <span>${new Date(s).getFullYear()}</span>\n                    <span>|</span>\n                    <span> R </span>\n                    <span>|</span>\n                    <span> 2hr 20min</span>\n                  </div>\n                </div>\n                <div class="film-page_rating">\n                  <span class="rating-star"><i class="${getClassByRate(a).star}"></i></span>\n                  <span class="rating-score ${getClassByRate(a).class}">${a}</span>\n                  <span class="reviews">87 875 <i class="fas fa-user-alt"></i></span>\n                </div>\n                <div class="film-page_genre">\n                  <span>${showMovieGenres(i)}</span>\n                </div>\n              </div>\n            </div>\n            <div class="movie-sources">\n              <ul class="play-button-group">\n                <li><a href="#" class="btn btn-sm btn-secondary wm-btn">4K <i class="fas fa-play"></i></a></li>\n                <li><a href="#" class="btn btn-sm btn-secondary wm-btn">HD <i class="fas fa-play"></i></a></li>\n                <li><a href="#" class="btn btn-sm btn-secondary wm-btn">SD <i class="fas fa-play"></i></a></li>\n                <li><a href="#" class="btn btn-sm btn-secondary wm-btn">IN THEATERS <i class="fas fa-film"></i></a></li>\n              </ul>\n            </div>\n          </div> \n          <div class="col-lg-6 col-sm-12">\n            <div class="movie-description">\n              <p>${o}</p>\n            </div>  \n          </div> \n        </div>\n        <div class="row">\n          <div class="iframe-container">\n            <iframe src="https://www.youtube.com/embed/ngWBddVNVZs?autoplay=1&start=13&mute=1" \n            allow="autoplay; picture-in-picture;" frameborder="0" allowfullscreen>\n            </iframe>\n          </div>\n        </div>\n      </div>\n    </section>\n\n    <section class="suggest-movie">\n      <div class="container">\n        <div class="title">\n          <h4>You Also May Like</h4>\n        </div>\n      </div>\n    </section>\n\n    <div class="container" style="padding-bottom: 10rem;">\n      <button data-tooltip=" Tooltip">Submit Form</button>\n    </div>\n  `}function toGenresList(e,n){n.innerHTML="",e.forEach(((e,t)=>{const{name:a}=e,r=document.createElement("li");r.classList.add("genre-list"),r.innerHTML=`<a href="">${a}</a>`,n.appendChild(r),r.addEventListener("click",(function(){}))}))}function toWeather(e){if(e.length<1)return weather.innerHTML="",void(weather.innerHTML="<div>No Weather Data</div>");weather.innerHTML="",weather.innerHTML="<div><strong>Weather Info:</strong></div>";const n=e.name,t=e.main.temp,a=e.weather[0].icon,r=e.weather[0].description,o=document.createElement("div");o.classList.add("weather"),o.innerHTML=`\n    lang.city: ${n}<br>\n    lang.temp: ${t} &deg;C <br>\n    <img class="weather-icon" src="http://openweathermap.org/img/wn/${a}@2x.png"> <br>\n    ${r}\n  `,weather.appendChild(o),o.addEventListener("click",(function(){}))}function toClientInfo(e){if(e.length<1)return clientInfo.innerHTML="",void(clientInfo.innerHTML="<div>No Client Data</div>");clientInfo.innerHTML="",clientInfo.innerHTML="<div><strong>Clientside Collected Info:</strong></div>";const n=document.createElement("div");n.classList.add("client-info"),n.innerHTML='\n    lang.ipaddress: ipaddress<br>\n    lang.proxy: proxy<br>\n    lang.latitude: latitude<br>\n    lang.longitude: longitude<br>\n    lang.city: city<br>\n    lang.country: country<br>\n    lang.timezone: timezone<br>\n    lang.os: os<br>\n    lang.osarchitecture: osarchitecture<br>\n    lang.os_ver: os_ver<br>\n    lang.browser: browser<br>\n    lang.browser_ver: browser_ver<br>\n    lang.sessionsip: sessionsip<br>\n    <div id="map">MAP</div>\n  ',clientInfo.appendChild(n),n.addEventListener("click",(function(){}))}function infiniteMarquee(){const e=document.documentElement,n=getComputedStyle(e).getPropertyValue("--marquee-elements-displayed"),t=document.querySelector(".marquee-content");e.style.setProperty("--marquee-elements",t.children.length);for(let e=0;e<n;e++)t.appendChild(t.children[e].cloneNode(!0))}console.log("connected 4_body.js"),initData(),document.addEventListener("click",(function(e){e.target&&"burger"==e.target.id&&console.log("listener attached to document")})),console.log("connected 5_marquee.js"),console.log("connected 6_security.js");
//# sourceMappingURL=main.min.js.map
